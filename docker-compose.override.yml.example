# =============================================================================
# Docker Compose Override - Local Development Configuration
# =============================================================================
#
# This file is automatically loaded by docker compose and overrides
# settings from docker-compose.yml for local development.
#
# Usage:
#   docker compose up -d                    # Uses both files automatically
#   docker compose -f docker-compose.yml up # Production only (no override)
#
# To use environment variables instead of secrets (for local dev):
#   1. Copy .env.example to .env
#   2. Fill in your development credentials
#   3. Run: docker compose up -d
#
# =============================================================================

services:
  # ---------------------------------------------------------------------------
  # PostgreSQL - Development overrides
  # ---------------------------------------------------------------------------
  postgres:
    # Expose port for local debugging
    ports:
      - "5432:5432"
    # Use environment variable instead of secret for local dev
    environment:
      POSTGRES_DB: tasks
      POSTGRES_USER: agent
      POSTGRES_PASSWORD: ${DB_PASSWORD:-devpassword}
    # Disable secrets requirement for local dev
    secrets: []

  # ---------------------------------------------------------------------------
  # Task MCP Server - Development overrides
  # ---------------------------------------------------------------------------
  task-mcp:
    # Expose on all interfaces for local testing
    ports:
      - "8001:8000"
    # Use environment variable for database URL
    environment:
      DATABASE_URL: postgresql://agent:${DB_PASSWORD:-devpassword}@postgres:5432/tasks
      AGENT_NAME: ${AGENT_NAME:-Dev Agent}
      AGENT_EMAIL: ${AGENT_EMAIL:-dev@local}
    # Disable secrets and read-only for development
    secrets: []
    read_only: false
    # Mount source for hot reload (optional)
    # volumes:
    #   - ./task_mcp_server:/app:ro

  # ---------------------------------------------------------------------------
  # Telegram MCP Server - Development overrides
  # ---------------------------------------------------------------------------
  telegram-mcp:
    # Expose on all interfaces for local testing
    ports:
      - "8002:8000"
    # Use environment variables instead of secrets
    environment:
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN:-}
      TELEGRAM_CHAT_ID: ${TELEGRAM_CHAT_ID:-}
    # Disable secrets and read-only for development
    secrets: []
    read_only: false
    # Mount source for hot reload (optional)
    # volumes:
    #   - ./telegram_mcp_server:/app:ro

# Disable secrets section for local development
secrets: {}
